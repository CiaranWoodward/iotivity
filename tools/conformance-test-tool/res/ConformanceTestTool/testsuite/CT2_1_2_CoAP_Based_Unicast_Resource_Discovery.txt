*** Settings ***
Documentation	CT2.1.2 CoAP Based Unicast Resource Discovery  
Resource          OIC_ConformanceTest_Setting.txt

*** Test Cases ***
CT2.1.2 CoAP Based Unicast Resource Discovery
    [Documentation]					
	...	|author	|	|	
	...	|reviewer|	|			
	...	|since	|2015-06-16|
	...	|see	|Section 11.2 : CoAP based endpoint discovery|
	...	|objective	|Verify Client (DUT) performs the unicast discovery procedure to discover resources  |
	...	|objective	|on a specific OIC Server (TE) on a network using CoAP discovery. |
	...	|target	|	|
	...	|test_data|	|
	...	|pre_condition|1. DUT does not have any discovered information for any Server in the network|
	...	|pre_condition|2. DUT shall first join the ‘All CoAP Nodes’ multicast group|
	...	|pre_condition|3. Servers must be discoverable to the DUT (same IP subnet, proximity, etc.)|
	...	|procedure| 1. On Client DUT, also connect and make server 1 and 2 discoverable |	
	...	|procedure| 2. Use the Test Application to initiate a unicast discovery request in DUT App|
	...	|procedure|    Case 1: with no query|
	...	|procedure|    Case 2: for a specific resource type (if applicable)|
	...	|procedure| 3. Server 1 (TE) and Server 2 will now send discovery response |
	...	|procedure| 4. DUT app Displays discovered resources |
	...	|post_condition| |
	...	|expected| 1. In Servers, both Case Source IP is Client’s IP|
	...	|expected| 2. In Servers, in both case Destination IP is Server 1 IP|
	...	|expected| 3. In Servers, in both case Code is “GET”|
	...	|expected| 4. In Servers, in case 2 rt query is present and is correctly formatted|
	...	|expected| 5. In the DUT App, after getting response, the discovered resources are correctly displayed|

    [Tags]    Mandatory    Client    Discovery
    Start Server
    Clear Request List
    Print Message    \n-----------------Send Multicast discovery request from DUT App-----------------
    Get Discovery Requests
    Print Message    \n-----------------Send Unicast discovery request with no query from DUT App-----------------
    Clear Request List
    ${request}    Get Discovery Requests

    ${request_code}       Get Request Code       ${request}
    Should Be Equal     ${GET}   ${request_code}
    ${request_ip}       Get Request Ip       ${request}
    Should Not Be Empty   ${request_ip}
    ${request_port}       Get Request Port       ${request}
    Should Not Be Empty   ${request_port}

    Clear Request List
