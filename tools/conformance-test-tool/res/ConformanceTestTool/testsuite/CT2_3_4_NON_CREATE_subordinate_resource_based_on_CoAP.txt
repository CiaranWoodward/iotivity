*** Settings ***
Documentation	CT2.3.4 NON CREATE subordinate resource based on CoAP 
Resource          OIC_ConformanceTest_Setting.txt

*** Test Cases ***
CT2.3.4 NON CREATE subordinate resource based on CoAP
    [Documentation]					
	...	|author	| |	
	...	|reviewer|	|			
	...	|since	|2015-06-16|
	...	|see	|Section 8.1: CREATE; Section 12.2.2|
	...	|objective	|Verify that the client (DUT) properly sends a NON CREATE request to create a subordinate resource on server (TE)  |
	...	|target	|	|
	...	|test_data|	|
	...	|pre_condition|1. Server (TE) is discovered from the Client (DUT) |
	...	|pre_condition|2. A resource collection exists on server |
	...	|procedure| 1. From Client DUT, Send a NON (low QoS) CREATE request message to create a subordinate resource on server|	
	...	|procedure| 2. From Server TE, Reply with a CREATE response message to client|
	...	|procedure| 3. From Client DUT, Receives CREATE response message from server and returns an Ack |
	...	|post_condition| |
	...	|expected| 1. Verify Client sends the request message including below|
	...	|expected|    In OIC Layer|
	...	|expected|       - fr, to, ri, cn, op|
	...	|expected|       - op = CREATE|
	...	|expected|       - cn include the URI and resource type property of the resource to be created. |
	...	|expected|    In CoAP Layer|
	...	|expected|       - Type = 1 (NON)|
	...	|expected|       - Code = 2 (POST)|
	...	|expected|    The payload of this POST includes the initial state of the resource.|

    [Tags]    Mandantory    Client    Non    Create
    #Pre-Condition
    ####################################################
    Start Server
    ConformanceKeyword.Log To Console    \n-----------------Send Multicast Discovery Request from DUT App-----------------
    Get Discovery Requests
    #Test-Body
    #####################################################
    ConformanceKeyword.Log To Console    \n-----------------Send NON CREATE subordinate resource based on CoAP from DUT App-----------------
    ${request}    Get Request
    ${request_code}    Get Request Code    ${request}
    Should Be Equal    ${request_code}    ${POST}
    ${request_type}    Get Request Type    ${request}
    Should Be Equal    ${request_type}    ${NON}
    ${payload}    Get Request Json    ${request}
    ${validate_json_result}     Validate JSON Format    ${payload}
    Should Be True    ${validate_json_result}
    ${received_href}    Get JSON Value    ${HREF}    ${payload}
    Should Not be Empty    ${received_href}
    ${resource_type}    Get JSON Value    ${RESOURCE_TYPE}    ${payload}
    Should Not be Empty    ${resource_type}
    Stop Server

